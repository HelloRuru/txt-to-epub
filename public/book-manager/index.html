<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5">

  <title>電子書書櫃管理 | Hello Ruru Tools</title>
  <meta name="description" content="跨平台電子書書櫃整合工具。匯入讀墨、Kobo 書單，自動偵測重複購買，整理你的電子書收藏。">
  <meta name="keywords" content="電子書,書櫃,讀墨,Readmoo,Kobo,重複,去重,管理">
  <meta name="author" content="Hello Ruru">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://tools.helloruru.com/book-manager/">

  <meta property="og:type" content="website">
  <meta property="og:title" content="電子書書櫃管理｜跨平台去重">
  <meta property="og:description" content="匯入讀墨、Kobo 書單，自動偵測重複購買，整理你的電子書收藏。">
  <meta property="og:url" content="https://tools.helloruru.com/book-manager/">
  <meta property="og:site_name" content="Hello Ruru Tools">
  <meta property="og:locale" content="zh_TW">

  <link rel="icon" type="image/svg+xml" href="/favicon.svg">

  <link rel="preconnect" href="https://lab.helloruru.com" crossorigin>
  <style>
    @font-face { font-family: 'GenSenRounded'; src: url('https://lab.helloruru.com/fonts/GenSenRounded-Regular.woff2') format('woff2'); font-weight: 400; font-display: swap; }
    @font-face { font-family: 'GenSenRounded'; src: url('https://lab.helloruru.com/fonts/GenSenRounded-Medium.woff2') format('woff2'); font-weight: 500; font-display: swap; }
    @font-face { font-family: 'GenSenRounded'; src: url('https://lab.helloruru.com/fonts/GenSenRounded-Bold.woff2') format('woff2'); font-weight: 700; font-display: swap; }
  </style>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap">

  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
  <script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>

  <link rel="stylesheet" href="css/style.css">

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "電子書書櫃管理",
    "url": "https://tools.helloruru.com/book-manager/",
    "description": "跨平台電子書書櫃整合工具，自動偵測重複購買",
    "applicationCategory": "UtilitiesApplication",
    "operatingSystem": "All",
    "author": { "@type": "Person", "name": "Kaoru Tsai" }
  }
  </script>
</head>
<body>
  <!-- Brand Header -->
  <header class="brand-header">
    <a href="https://tools.helloruru.com" class="brand-link">
      <span class="brand-name">Hello Ruru Tools</span>
    </a>
    <div class="header-actions">
      <button class="btn-icon" id="btn-dark-mode" aria-label="切換深色模式">
        <i data-lucide="moon" width="18" height="18"></i>
      </button>
    </div>
  </header>

  <!-- Page Title -->
  <div class="page-title">
    <h1><i data-lucide="library" width="24" height="24"></i> 電子書書櫃管理</h1>
    <p class="page-subtitle">匯入各平台書單，一眼找出重複購買</p>
  </div>

  <!-- Tab Navigation -->
  <nav class="tab-nav" role="tablist">
    <button class="tab active" data-tab="import" role="tab" aria-selected="true">
      <i data-lucide="upload" width="16" height="16"></i>
      <span class="tab-label">匯入</span>
    </button>
    <button class="tab" data-tab="library" role="tab" aria-selected="false">
      <i data-lucide="book-open" width="16" height="16"></i>
      <span class="tab-label">書櫃</span>
      <span class="tab-badge" id="badge-library" style="display:none">0</span>
    </button>
    <button class="tab" data-tab="stats" role="tab" aria-selected="false">
      <i data-lucide="bar-chart-3" width="16" height="16"></i>
      <span class="tab-label">統計</span>
    </button>
  </nav>

  <!-- Tab Content -->
  <main class="tab-content">

    <!-- ── Tab: Import ── -->
    <section id="panel-import" class="panel active" role="tabpanel">
      <!-- Drop zone -->
      <div class="import-section">
        <h2><i data-lucide="file-json" width="18" height="18"></i> 從擴充匯入</h2>
        <p class="section-desc">使用 eBook Shelf Helper 擴充撈取書櫃後，匯出的 JSON 檔拖到這裡。</p>
        <div class="drop-zone" id="drop-zone">
          <i data-lucide="upload-cloud" width="40" height="40"></i>
          <p>拖放 JSON 檔案到這裡</p>
          <p class="drop-hint">或點擊選擇檔案</p>
          <input type="file" id="file-input" accept=".json,.csv" style="display:none">
        </div>
      </div>

      <!-- Paste -->
      <div class="import-section">
        <h2><i data-lucide="clipboard-paste" width="18" height="18"></i> 手動貼上書名</h2>
        <p class="section-desc">一行一本。格式：<code>書名</code> 或 <code>書名,作者</code></p>
        <div class="paste-controls">
          <select id="paste-platform" class="select">
            <option value="readmoo">讀墨 Readmoo</option>
            <option value="kobo">樂天 Kobo</option>
            <option value="calibre">Calibre / 本機</option>
          </select>
        </div>
        <textarea id="paste-area" class="textarea" rows="6" placeholder="被討厭的勇氣&#10;原子習慣,James Clear&#10;人類大歷史"></textarea>
        <button class="btn btn-primary" id="btn-paste-import">
          <i data-lucide="plus" width="16" height="16"></i> 匯入
        </button>
      </div>

      <!-- CSV upload -->
      <div class="import-section">
        <h2><i data-lucide="file-spreadsheet" width="18" height="18"></i> CSV 上傳</h2>
        <p class="section-desc">CSV 檔案需含 <code>title</code> 或 <code>書名</code> 欄位。</p>
        <div class="csv-upload">
          <button class="btn btn-outline" id="btn-csv-upload">
            <i data-lucide="upload" width="16" height="16"></i> 選擇 CSV 檔
          </button>
          <input type="file" id="csv-input" accept=".csv" style="display:none">
          <select id="csv-platform" class="select">
            <option value="readmoo">讀墨</option>
            <option value="kobo">Kobo</option>
            <option value="calibre">Calibre / 本機</option>
          </select>
        </div>
      </div>

      <!-- Import Preview Modal -->
      <div class="modal-overlay" id="modal-preview" style="display:none">
        <div class="modal">
          <div class="modal-header">
            <h3>匯入預覽</h3>
            <button class="btn-icon modal-close" id="btn-preview-close">
              <i data-lucide="x" width="18" height="18"></i>
            </button>
          </div>
          <div class="modal-body">
            <p id="preview-summary"></p>
            <div class="preview-list" id="preview-list"></div>
          </div>
          <div class="modal-footer">
            <button class="btn btn-outline" id="btn-preview-cancel">取消</button>
            <button class="btn btn-primary" id="btn-preview-confirm">
              <i data-lucide="check" width="16" height="16"></i> 確認匯入
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- ── Tab: Library ── -->
    <section id="panel-library" class="panel" role="tabpanel" style="display:none">
      <div class="library-toolbar">
        <div class="search-box">
          <i data-lucide="search" width="16" height="16"></i>
          <input type="text" id="library-search" placeholder="搜尋書名或作者...">
        </div>
        <div class="filter-group">
          <button class="filter-btn active" data-filter="all">全部</button>
          <button class="filter-btn" data-filter="duplicate">重複</button>
          <button class="filter-btn" data-filter="readmoo">讀墨</button>
          <button class="filter-btn" data-filter="kobo">Kobo</button>
          <button class="filter-btn" data-filter="calibre">本機</button>
        </div>
      </div>

      <div class="library-info" id="library-info"></div>

      <!-- Duplicate groups -->
      <div id="duplicate-groups"></div>

      <!-- Book list -->
      <div class="book-list" id="book-list">
        <div class="empty-state" id="empty-library">
          <i data-lucide="book-x" width="48" height="48"></i>
          <p>書櫃是空的</p>
          <p class="empty-hint">到「匯入」分頁加入你的書單</p>
        </div>
      </div>
    </section>

    <!-- ── Tab: Stats ── -->
    <section id="panel-stats" class="panel" role="tabpanel" style="display:none">
      <div class="stats-grid" id="stats-grid">
        <div class="stat-card">
          <div class="stat-number" id="stat-total">0</div>
          <div class="stat-label">總藏書</div>
        </div>
        <div class="stat-card stat-danger">
          <div class="stat-number" id="stat-duplicates">0</div>
          <div class="stat-label">重複書</div>
        </div>
        <div class="stat-card" style="--accent:#00C1FF">
          <div class="stat-number" id="stat-readmoo">0</div>
          <div class="stat-label">讀墨</div>
        </div>
        <div class="stat-card" style="--accent:#BF0000">
          <div class="stat-number" id="stat-kobo">0</div>
          <div class="stat-label">Kobo</div>
        </div>
        <div class="stat-card" style="--accent:#06A865">
          <div class="stat-number" id="stat-calibre">0</div>
          <div class="stat-label">本機</div>
        </div>
      </div>

      <!-- Chart -->
      <div class="chart-section">
        <h2>平台分布</h2>
        <div class="pie-chart" id="pie-chart"></div>
      </div>

      <!-- Export -->
      <div class="export-section">
        <h2><i data-lucide="download" width="18" height="18"></i> 匯出</h2>
        <div class="export-buttons">
          <button class="btn btn-outline" id="btn-export-json">
            <i data-lucide="file-json" width="16" height="16"></i> JSON 備份
          </button>
          <button class="btn btn-outline" id="btn-export-csv">
            <i data-lucide="file-spreadsheet" width="16" height="16"></i> CSV
          </button>
          <button class="btn btn-outline" id="btn-export-text">
            <i data-lucide="file-text" width="16" height="16"></i> 純文字
          </button>
          <button class="btn btn-outline" id="btn-export-dupes">
            <i data-lucide="copy" width="16" height="16"></i> 僅重複書
          </button>
        </div>
      </div>

      <!-- Danger zone -->
      <div class="danger-section">
        <button class="btn btn-danger" id="btn-clear-all">
          <i data-lucide="trash-2" width="16" height="16"></i> 清空全部資料
        </button>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <p>&copy; 2026 <a href="https://ohruru.com" target="_blank">Kaoru Tsai</a>. All rights reserved.</p>
  </footer>

  <!-- Scripts -->
  <script src="js/app.js"></script>
  <script src="js/import.js"></script>
  <script src="js/library.js"></script>
</body>
</html>
