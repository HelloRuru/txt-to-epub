<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5">
  <title>問安圖產生器｜免費線上早安圖製作工具，7 種字體 + 配件貼紙一鍵下載</title>
  <meta name="description" content="免費問安圖產生器，3 步驟製作早安圖、午安圖、晚安圖。提供 7 種中文字體、6 款花卉蝴蝶配件、一行禪師智慧語錄，自動帶入日期時間，免註冊免安裝，長輩也能輕鬆上手。">
  <meta name="keywords" content="問安圖產生器,早安圖製作,長輩圖產生器,免費早安圖,午安圖,晚安圖,問候圖片製作,線上圖片編輯,早安問候語,長輩圖免費下載">
  <link rel="canonical" href="https://tools.helloruru.com/hihi/">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="問安圖產生器｜免費線上早安圖、午安圖、晚安圖製作工具">
  <meta property="og:description" content="選背景、打字、下載！7 種中文字體 + 蓮花蝴蝶配件貼紙 + 一行禪師智慧語錄，自動帶入日期時間，3 步驟完成溫馨問安圖。">
  <meta property="og:url" content="https://tools.helloruru.com/hihi/">
  <meta property="og:site_name" content="Hello Ruru Tools">
  <meta property="og:locale" content="zh_TW">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="問安圖產生器｜免費線上早安圖製作工具">
  <meta name="twitter:description" content="選背景、打字、下載！7 種字體 + 配件貼紙 + 智慧語錄，3 步驟完成溫馨問安圖。">

  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "問安圖產生器",
    "alternateName": ["早安圖產生器", "長輩圖產生器", "問候圖製作工具"],
    "description": "免費線上問安圖製作工具，提供 7 種中文字體、6 款花卉配件貼紙、一行禪師智慧語錄，自動帶入日期時間，3 步驟完成早安圖、午安圖、晚安圖。",
    "url": "https://tools.helloruru.com/hihi/",
    "applicationCategory": "DesignApplication",
    "operatingSystem": "All",
    "browserRequirements": "Requires JavaScript",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "TWD"
    },
    "featureList": [
      "7 種中文字體（圓體、楷體、手寫、明體、黑體、粉圓、日丸）",
      "6 款配件貼紙（蓮花、向日葵、蝴蝶、櫻花、愛心、星星）",
      "一行禪師智慧語錄推薦",
      "自動帶入日期時間",
      "文字 9 宮格位置調整",
      "分行獨立文字顏色選擇",
      "致 / 來自署名功能",
      "一鍵下載 PNG 圖片",
      "自適應桌面、平板、手機"
    ],
    "author": {
      "@type": "Person",
      "name": "Kaoru Tsai",
      "url": "https://lab.helloruru.com"
    }
  }
  </script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "問安圖產生器怎麼用？",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "只要 3 步驟：1. 選一張背景照片 2. 選問候語或自己打字，調整字體、顏色、大小、位置 3. 點下載就完成了。還可以加蓮花、蝴蝶等可愛配件。"
        }
      },
      {
        "@type": "Question",
        "name": "問安圖產生器有哪些字體可以選？",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "提供 7 種免費中文字體：源泉圓體（圓體）、霞鶩文楷（楷體）、何某手寫體（手寫）、思源宋體（明體）、思源黑體（黑體）、jf 開源粉圓（粉圓）、Zen Maru Gothic（日丸），全部免費商用。"
        }
      },
      {
        "@type": "Question",
        "name": "問安圖產生器需要付費或註冊嗎？",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "完全免費，不需要註冊帳號，也不需要安裝任何軟體。打開網頁就能直接使用，圖片在你的裝置上產生，不會上傳到伺服器。"
        }
      },
      {
        "@type": "Question",
        "name": "早安圖和問安圖有什麼不同？",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "早安圖是問安圖的其中一種。問安圖泛指所有問候用途的圖片，包含早安圖、午安圖、晚安圖等。本工具會根據你使用的時間，自動推薦對應的問候語和日期時間。"
        }
      }
    ]
  }
  </script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      { "@type": "ListItem", "position": 1, "name": "Hello Ruru Tools", "item": "https://tools.helloruru.com/" },
      { "@type": "ListItem", "position": 2, "name": "問安圖產生器", "item": "https://tools.helloruru.com/hihi/" }
    ]
  }
  </script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=LXGW+WenKai+TC:wght@400;700&family=Noto+Serif+TC:wght@400;700&family=Zen+Maru+Gothic:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* ─── Design System v1.6 Font Faces ─── */
    @font-face {
      font-family: 'GenSenRounded';
      src: url('https://lab.helloruru.com/fonts/GenSenRounded-Regular.woff2') format('woff2');
      font-weight: 400; font-style: normal; font-display: swap;
    }
    @font-face {
      font-family: 'GenSenRounded';
      src: url('https://lab.helloruru.com/fonts/GenSenRounded-Medium.woff2') format('woff2');
      font-weight: 500; font-style: normal; font-display: swap;
    }
    @font-face {
      font-family: 'GenSenRounded';
      src: url('https://lab.helloruru.com/fonts/GenSenRounded-Bold.woff2') format('woff2');
      font-weight: 700; font-style: normal; font-display: swap;
    }
    @font-face {
      font-family: 'NaniFont';
      src: url('https://cdn.jsdelivr.net/gh/max32002/nanifont@1.046/webfont/NaniFont-Regular.woff2') format('woff2');
      font-weight: 400; font-display: swap;
    }
    @font-face {
      font-family: 'NaniFont';
      src: url('https://cdn.jsdelivr.net/gh/max32002/nanifont@1.046/webfont/NaniFont-SemiBold.woff2') format('woff2');
      font-weight: 700; font-display: swap;
    }
    @font-face {
      font-family: 'jf-openhuninn';
      src: url('https://cdn.jsdelivr.net/gh/justfont/open-huninn-font@2.0/font/jf-openhuninn-2.0.woff2') format('woff2');
      font-weight: 400; font-display: swap;
    }

    /* ─── Design System v1.6 CSS Variables ─── */
    :root {
      /* Colors */
      --color-rose: #D4A5A5;
      --color-lavender: #B8A9C9;
      --color-blush: #F5D0C5;
      --color-grey-rose: #C9929A;
      --color-nadeshiko: #E8B4B8;
      --color-sakura: #FEDFE1;
      --color-wisteria: #C4B7D7;
      --color-bellflower: #8F77B5;
      --color-sage: #A8B5A0;
      --color-mist: #E8E4E1;
      --color-warm-grey: #B5ADA7;
      --color-charcoal: #5C5856;
      --color-ink: #333333;
      --color-body: #4A4A4A;
      --color-muted: #888888;
      --color-light: #AAAAAA;
      --color-bg: #FAFAFA;
      --color-card: #FFFFFF;

      /* Font Families */
      --font-heading: 'GenSenRounded', 'Noto Sans TC', sans-serif;
      --font-body: 'GenSenRounded', 'Noto Sans TC', sans-serif;
      --font-caption: 'Noto Sans TC', sans-serif;

      /* Font Sizes — Desktop */
      --text-h1: 2.5rem;
      --text-h2: 1.75rem;
      --text-h3: 1.25rem;
      --text-body: 1rem;
      --text-small: 0.875rem;
      --text-caption: 0.75rem;

      /* Font Weights */
      --weight-regular: 400;
      --weight-medium: 500;
      --weight-bold: 700;

      /* Line Heights */
      --leading-tight: 1.3;
      --leading-normal: 1.6;
      --leading-relaxed: 1.8;

      /* Letter Spacing */
      --tracking-tight: -0.01em;
      --tracking-normal: 0.02em;
      --tracking-wide: 0.08em;

      /* Radius */
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 24px;
      --radius-full: 50%;

      /* Shadows */
      --shadow-soft: 0 2px 8px rgba(0,0,0,0.06);
      --shadow-md: 0 4px 16px rgba(0,0,0,0.08);
      --shadow-lg: 0 8px 32px rgba(0,0,0,0.12);

      /* Gradients */
      --gradient-main: linear-gradient(135deg, #D4A5A5, #B8A9C9);
      --gradient-light: linear-gradient(180deg, #FFFFFF, #FAFAFA);
      --gradient-pink-purple: linear-gradient(135deg, #F5D0C5, #C4B7D7);
    }

    /* ─── Mobile Font Size Overrides ─── */
    @media (max-width: 768px) {
      :root {
        --text-h1: 1.875rem;
        --text-h2: 1.5rem;
        --text-h3: 1.125rem;
      }
    }

    /* ─── Reset ─── */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    /* ─── Base ─── */
    body {
      font-family: var(--font-body);
      font-weight: var(--weight-medium);
      font-size: var(--text-body);
      line-height: var(--leading-relaxed);
      letter-spacing: var(--tracking-normal);
      background: var(--color-bg);
      color: var(--color-body);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      -webkit-tap-highlight-color: transparent;
    }

    /* ─── Page Container ─── */
    .page {
      max-width: 960px;
      margin: 0 auto;
      padding: 32px 24px 48px;
    }

    /* ─── Header ─── */
    .page-header { text-align: center; margin-bottom: 32px; }

    h1 {
      font-family: var(--font-heading);
      font-weight: var(--weight-bold);
      font-size: var(--text-h1);
      line-height: var(--leading-tight);
      letter-spacing: var(--tracking-tight);
      color: var(--color-ink);
      margin-bottom: 8px;
    }

    .greeting-banner {
      font-family: var(--font-heading);
      font-size: var(--text-h3);
      color: var(--color-rose);
      font-weight: var(--weight-bold);
      line-height: var(--leading-normal);
    }

    /* ─── Two-Column Desktop Layout ─── */
    .layout {
      display: grid;
      grid-template-columns: 1fr;
      gap: 32px;
    }

    @media (min-width: 1024px) {
      .layout {
        grid-template-columns: 1fr 1fr;
        gap: 40px;
        align-items: start;
      }
      .preview-col {
        position: sticky;
        top: 24px;
      }
    }

    /* ─── Steps ─── */
    .step { margin-bottom: 28px; }

    .step-label {
      font-family: var(--font-heading);
      font-size: var(--text-h3);
      font-weight: var(--weight-bold);
      line-height: var(--leading-tight);
      color: var(--color-rose);
      margin-bottom: 12px;
    }

    /* ─── Upload Area ─── */
    .upload-area {
      border: 2px dashed var(--color-mist);
      border-radius: var(--radius-lg);
      padding: 40px 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
      background: var(--color-card);
    }
    .upload-area:hover, .upload-area.dragover {
      border-color: var(--color-rose);
      background: #FFF9F9;
    }
    .upload-area.has-image {
      padding: 12px;
      border-style: solid;
      border-color: var(--color-rose);
    }
    .upload-area svg { width: 48px; height: 48px; color: var(--color-rose); margin-bottom: 12px; }
    .upload-text { font-size: var(--text-h3); color: var(--color-muted); }
    .upload-hint { font-size: var(--text-small); color: var(--color-light); margin-top: 4px; }
    .upload-area.has-image .upload-placeholder { display: none; }
    #upload-input { display: none; }
    #preview-thumb { display: none; max-width: 100%; border-radius: calc(var(--radius-lg) - 4px); }
    .upload-area.has-image #preview-thumb { display: block; }

    /* ─── Greeting Sections ─── */
    .greeting-section { margin-bottom: 16px; }
    .greeting-sub-label {
      font-family: var(--font-caption);
      font-size: var(--text-small);
      color: var(--color-muted);
      margin-bottom: 8px;
    }
    .greeting-row { display: flex; gap: 8px; flex-wrap: wrap; }

    .greeting-btn, .wisdom-btn {
      padding: 10px 18px;
      border: 2px solid var(--color-mist);
      border-radius: var(--radius-lg);
      background: var(--color-card);
      font-family: var(--font-body);
      font-weight: var(--weight-medium);
      cursor: pointer;
      transition: all 0.2s;
      color: var(--color-ink);
      min-height: 44px;
    }
    .greeting-btn { font-size: var(--text-body); }
    .wisdom-btn { font-size: var(--text-small); }
    .greeting-btn:hover { border-color: var(--color-rose); }
    .greeting-btn.active { background: var(--color-rose); border-color: var(--color-rose); color: #FFF; }
    .wisdom-btn:hover { border-color: var(--color-lavender); }
    .wisdom-btn.active { background: var(--color-lavender); border-color: var(--color-lavender); color: #FFF; }

    /* ─── Textarea ─── */
    textarea {
      width: 100%;
      min-height: 100px;
      border: 2px solid var(--color-mist);
      border-radius: calc(var(--radius-lg) - 8px);
      padding: 16px;
      font-family: var(--font-body);
      font-size: var(--text-h3);
      font-weight: var(--weight-medium);
      color: var(--color-ink);
      resize: vertical;
      transition: border-color 0.2s;
      background: var(--color-card);
    }
    textarea::placeholder { color: var(--color-light); }
    textarea:focus { outline: none; border-color: var(--color-rose); }

    /* ─── Name Inputs ─── */
    .name-input {
      flex: 1;
      min-width: 0;
      padding: 10px 14px;
      border: 2px solid var(--color-mist);
      border-radius: var(--radius-md);
      font-family: var(--font-body);
      font-size: var(--text-body);
      font-weight: var(--weight-medium);
      color: var(--color-ink);
      background: var(--color-card);
      transition: border-color 0.2s;
      min-height: 44px;
    }
    .name-input::placeholder { color: var(--color-light); }
    .name-input:focus { outline: none; border-color: var(--color-rose); }

    /* ─── Option Rows ─── */
    .option-row {
      display: flex;
      gap: 8px;
      margin-top: 12px;
      flex-wrap: wrap;
      align-items: center;
    }
    .option-label {
      font-size: var(--text-body);
      color: var(--color-muted);
      min-width: fit-content;
      font-weight: var(--weight-medium);
    }

    /* ─── Pill Buttons (font, size) ─── */
    .pill-btn {
      padding: 8px 16px;
      border: 2px solid var(--color-mist);
      border-radius: var(--radius-lg);
      background: var(--color-card);
      font-family: var(--font-body);
      font-size: var(--text-small);
      font-weight: var(--weight-medium);
      cursor: pointer;
      transition: all 0.2s;
      color: var(--color-ink);
      min-height: 44px;
    }
    .pill-btn:hover { border-color: var(--color-rose); }
    .pill-btn.active { background: var(--color-rose); border-color: var(--color-rose); color: #FFF; }
    .pill-btn.lavender:hover { border-color: var(--color-lavender); }
    .pill-btn.lavender.active { background: var(--color-lavender); border-color: var(--color-lavender); color: #FFF; }

    /* ─── Font Button Preview ─── */
    .font-btn[data-font="gensenrounded"] { font-family: 'GenSenRounded', sans-serif; }
    .font-btn[data-font="wenkai"] { font-family: 'LXGW WenKai TC', serif; }
    .font-btn[data-font="nanifont"] { font-family: 'NaniFont', sans-serif; }
    .font-btn[data-font="notoserif"] { font-family: 'Noto Serif TC', serif; }
    .font-btn[data-font="notosans"] { font-family: 'Noto Sans TC', sans-serif; }
    .font-btn[data-font="huninn"] { font-family: 'jf-openhuninn', sans-serif; }
    .font-btn[data-font="zenmaru"] { font-family: 'Zen Maru Gothic', sans-serif; }

    /* ─── Color Dots ─── */
    .color-dot {
      width: 44px; height: 44px;
      border-radius: var(--radius-full);
      border: 3px solid transparent;
      cursor: pointer;
      transition: all 0.2s;
    }
    .color-dot:hover { transform: scale(1.1); }
    .color-dot.active { border-color: var(--color-ink); transform: scale(1.1); }

    /* ─── Color Cycle Button (致/來自) ─── */
    .color-cycle {
      width: 32px; height: 32px;
      border-radius: var(--radius-full);
      border: 2px solid var(--color-mist);
      cursor: pointer;
      transition: all 0.2s;
      flex-shrink: 0;
    }
    .color-cycle:hover { transform: scale(1.15); }

    /* ─── Position Grid ─── */
    .pos-wrap { display: flex; gap: 10px; align-items: center; margin-top: 12px; }
    .pos-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 4px; }
    .pos-btn {
      width: 52px; height: 40px;
      border: 2px solid var(--color-mist);
      border-radius: var(--radius-sm);
      background: var(--color-card);
      font-family: var(--font-body);
      font-size: var(--text-caption);
      font-weight: var(--weight-medium);
      cursor: pointer;
      transition: all 0.2s;
      color: var(--color-ink);
      padding: 0;
    }
    .pos-btn:hover { border-color: var(--color-rose); }
    .pos-btn.active { background: var(--color-rose); border-color: var(--color-rose); color: #FFF; }

    /* ─── Sticker Grid ─── */
    .sticker-grid {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 8px;
    }
    .sticker-thumb {
      width: 64px; height: 64px;
      border: 2px solid var(--color-mist);
      border-radius: calc(var(--radius-lg) - 8px);
      background: var(--color-card);
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 6px;
    }
    .sticker-thumb:hover { border-color: var(--color-rose); transform: scale(1.05); }
    .sticker-thumb.active { border-color: var(--color-rose); background: #FFF5F5; }
    .sticker-thumb img { width: 100%; height: 100%; object-fit: contain; }
    .sticker-name {
      font-family: var(--font-caption);
      font-size: var(--text-caption);
      color: var(--color-muted);
      text-align: center;
      margin-top: 2px;
    }

    /* ─── Sticker Controls ─── */
    .sticker-controls {
      margin-top: 12px;
      padding: 16px;
      background: var(--color-card);
      border: 2px solid var(--color-mist);
      border-radius: var(--radius-lg);
      display: none;
    }
    .sticker-controls.show { display: block; }
    .sticker-controls-title {
      font-size: var(--text-small);
      color: var(--color-rose);
      font-weight: var(--weight-bold);
      margin-bottom: 10px;
    }
    .slider-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }
    .slider-row:last-child { margin-bottom: 0; }
    .slider-label {
      font-size: var(--text-small);
      color: var(--color-muted);
      min-width: 36px;
    }
    .slider-row input[type="range"] {
      flex: 1;
      height: 6px;
      -webkit-appearance: none;
      appearance: none;
      background: var(--color-mist);
      border-radius: 3px;
      outline: none;
    }
    .slider-row input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 28px; height: 28px;
      border-radius: var(--radius-full);
      background: var(--color-rose);
      cursor: pointer;
      border: 2px solid var(--color-card);
      box-shadow: var(--shadow-soft);
    }
    .slider-row input[type="range"]::-moz-range-thumb {
      width: 28px; height: 28px;
      border-radius: var(--radius-full);
      background: var(--color-rose);
      cursor: pointer;
      border: 2px solid var(--color-card);
    }

    /* ─── Canvas Preview ─── */
    .preview-wrap {
      border-radius: var(--radius-lg);
      overflow: hidden;
      box-shadow: var(--shadow-md);
      background: var(--color-card);
    }
    #canvas {
      display: block;
      width: 100%;
      height: auto;
      border-radius: var(--radius-lg);
    }

    /* ─── Download Button ─── */
    .btn {
      display: flex; align-items: center; justify-content: center;
      gap: 8px; width: 100%; padding: 16px; border: none;
      border-radius: var(--radius-lg);
      font-family: var(--font-heading);
      font-size: var(--text-h3);
      font-weight: var(--weight-bold);
      cursor: pointer; transition: all 0.2s;
      min-height: 56px;
    }
    .btn svg { width: 24px; height: 24px; }
    .btn-primary {
      background: var(--gradient-main);
      color: #FFF;
      box-shadow: 0 4px 16px rgba(212,165,165,0.3);
    }
    .btn-primary:hover {
      box-shadow: 0 8px 24px rgba(212,165,165,0.4);
      transform: translateY(-1px);
    }
    .btn-primary:active { transform: translateY(0); }
    .btn-primary:disabled { opacity: 0.4; cursor: not-allowed; transform: none; box-shadow: none; }

    /* ─── Toast ─── */
    .toast {
      position: fixed; bottom: 24px; left: 50%;
      transform: translateX(-50%) translateY(80px);
      background: var(--color-charcoal); color: #FFF;
      font-size: var(--text-body); font-weight: var(--weight-medium);
      padding: 12px 24px; border-radius: var(--radius-lg);
      opacity: 0; transition: all 0.3s; z-index: 10; pointer-events: none;
    }
    .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

    /* ─── Footer ─── */
    .footer {
      text-align: center; padding: 32px 0 0;
      font-family: var(--font-caption);
      font-size: var(--text-small);
      color: var(--color-muted);
    }
    .footer a { color: var(--color-rose); text-decoration: none; }

    /* ─── Tablet (768–1023px) ─── */
    @media (min-width: 768px) and (max-width: 1023px) {
      .page { max-width: 640px; padding: 40px 32px 48px; }
      .greeting-row { gap: 10px; }
      .sticker-thumb { width: 72px; height: 72px; }
    }

    /* ─── Desktop (≥1024px) ─── */
    @media (min-width: 1024px) {
      .page { padding: 48px 40px 56px; }
      .greeting-row { gap: 10px; }
      .sticker-thumb { width: 72px; height: 72px; }
      .pos-btn { width: 56px; height: 44px; font-size: var(--text-small); }
    }

    /* ─── Small Mobile (<400px) ─── */
    @media (max-width: 400px) {
      .page { padding: 20px 16px 32px; }
      .greeting-btn, .wisdom-btn { padding: 8px 14px; font-size: var(--text-small); }
      .pill-btn { padding: 8px 12px; font-size: var(--text-caption); }
      .option-row { gap: 6px; }
      .color-dot { width: 38px; height: 38px; }
      .sticker-thumb { width: 56px; height: 56px; }
      .pos-btn { width: 46px; height: 36px; }
      .name-input { font-size: var(--text-small); padding: 8px 10px; }
    }

    /* ─── Touch Optimization ─── */
    @media (hover: none) and (pointer: coarse) {
      .greeting-btn:hover, .wisdom-btn:hover, .pill-btn:hover,
      .pos-btn:hover, .sticker-thumb:hover, .color-dot:hover,
      .color-cycle:hover, .upload-area:hover, .btn-primary:hover {
        transform: none;
        box-shadow: inherit;
      }
      .greeting-btn:active, .wisdom-btn:active, .pill-btn:active,
      .pos-btn:active, .sticker-thumb:active {
        transform: scale(0.96);
      }
      .btn-primary:active:not(:disabled) {
        transform: scale(0.98);
      }
    }
  </style>
</head>
<body>

<div class="page">
  <header class="page-header">
    <h1>問安圖產生器</h1>
    <p class="greeting-banner" id="greeting-banner"></p>
  </header>

  <div class="layout">
    <!-- ─── Controls Column ─── -->
    <div class="controls-col">

      <!-- Step 1 -->
      <div class="step">
        <div class="step-label">1. 選一張背景</div>
        <div class="upload-area" id="upload-area">
          <div class="upload-placeholder">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><path d="m21 15-5-5L5 21"/></svg>
            <div class="upload-text">點這裡選照片</div>
            <div class="upload-hint">或把圖片拖進來</div>
          </div>
          <img id="preview-thumb" alt="背景預覽">
        </div>
        <input type="file" id="upload-input" accept="image/*">
      </div>

      <!-- Step 2 -->
      <div class="step">
        <div class="step-label">2. 選問候語</div>

        <div class="greeting-section">
          <div class="greeting-sub-label">基本問候</div>
          <div class="greeting-row" id="basic-row"></div>
        </div>
        <div class="greeting-section">
          <div class="greeting-sub-label">智慧推薦 — 一行禪師</div>
          <div class="greeting-row" id="wisdom-row"></div>
        </div>

        <textarea id="text-input" placeholder="在這裡打字..."></textarea>

        <div class="option-row" style="margin-top:12px; margin-bottom:0;">
          <span class="option-label">致</span>
          <input type="text" id="input-to" class="name-input" placeholder="收件人（選填）">
          <div class="color-cycle" id="color-to" title="點我換顏色" style="background:#FFFFFF; border-color:#CCC;"></div>
          <span class="option-label" style="margin-left:4px;">來自</span>
          <input type="text" id="input-from" class="name-input" placeholder="你的名字（選填）">
          <div class="color-cycle" id="color-from" title="點我換顏色" style="background:#FFFFFF; border-color:#CCC;"></div>
        </div>

        <div class="option-row">
          <span class="option-label">字體</span>
          <button class="pill-btn lavender font-btn active" data-font="gensenrounded">圓體</button>
          <button class="pill-btn lavender font-btn" data-font="wenkai">楷體</button>
          <button class="pill-btn lavender font-btn" data-font="nanifont">手寫</button>
          <button class="pill-btn lavender font-btn" data-font="notoserif">明體</button>
          <button class="pill-btn lavender font-btn" data-font="notosans">黑體</button>
          <button class="pill-btn lavender font-btn" data-font="huninn">粉圓</button>
          <button class="pill-btn lavender font-btn" data-font="zenmaru">日丸</button>
        </div>

        <div class="option-row">
          <span class="option-label">問候語</span>
          <div class="color-dot active" data-color="#FFFFFF" style="background:#FFFFFF; border-color:#CCC;"></div>
          <div class="color-dot" data-color="#FFFF00" style="background:#FFFF00"></div>
          <div class="color-dot" data-color="#FF6B6B" style="background:#FF6B6B"></div>
          <div class="color-dot" data-color="#333333" style="background:#333333"></div>
          <div class="color-dot" data-color="#FFD700" style="background:#FFD700"></div>
        </div>

        <div class="option-row">
          <span class="option-label">大小</span>
          <button class="pill-btn size-btn" data-size="36">小</button>
          <button class="pill-btn size-btn active" data-size="52">中</button>
          <button class="pill-btn size-btn" data-size="72">大</button>
        </div>

        <div class="pos-wrap">
          <span class="option-label">位置</span>
          <div class="pos-grid">
            <button class="pos-btn" data-pos="tl">左上</button>
            <button class="pos-btn" data-pos="tc">上</button>
            <button class="pos-btn" data-pos="tr">右上</button>
            <button class="pos-btn" data-pos="ml">左</button>
            <button class="pos-btn active" data-pos="mc">中</button>
            <button class="pos-btn" data-pos="mr">右</button>
            <button class="pos-btn" data-pos="bl">左下</button>
            <button class="pos-btn" data-pos="bc">下</button>
            <button class="pos-btn" data-pos="br">右下</button>
          </div>
        </div>
      </div>

      <!-- Step 3: Stickers -->
      <div class="step">
        <div class="step-label">3. 加個配件</div>
        <div class="greeting-sub-label">點選即可加到圖上，再點一次取消</div>
        <div class="sticker-grid" id="sticker-grid"></div>
        <div class="sticker-controls" id="sticker-controls">
          <div class="sticker-controls-title" id="sticker-controls-title"></div>
          <div class="slider-row">
            <span class="slider-label">水平</span>
            <input type="range" id="sticker-x" min="0" max="700" value="0">
          </div>
          <div class="slider-row">
            <span class="slider-label">垂直</span>
            <input type="range" id="sticker-y" min="0" max="700" value="0">
          </div>
          <div class="slider-row">
            <span class="slider-label">大小</span>
            <input type="range" id="sticker-size" min="60" max="350" value="130">
          </div>
        </div>
      </div>

    </div><!-- /.controls-col -->

    <!-- ─── Preview Column ─── -->
    <div class="preview-col">
      <div class="step">
        <div class="step-label">4. 預覽和下載</div>
        <div class="preview-wrap">
          <canvas id="canvas" width="800" height="800"></canvas>
        </div>
      </div>

      <button class="btn btn-primary" id="btn-download" disabled>
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
        下載圖片
      </button>
    </div><!-- /.preview-col -->

  </div><!-- /.layout -->

  <footer class="footer">
    <p>&copy; <span id="yr"></span> Kaoru Tsai. All Rights Reserved. | Contact: <a href="mailto:hello@helloruru.com">hello@helloruru.com</a></p>
  </footer>
</div>

<div class="toast" id="toast"></div>

<script>
  // ─── Time ───
  function getTimeGreeting() {
    const h = new Date().getHours();
    if (h >= 5 && h < 12) return '早安';
    if (h >= 12 && h < 18) return '午安';
    return '晚安';
  }
  function getDateTimeStr() {
    const now = new Date();
    const m = now.getMonth() + 1, d = now.getDate();
    const w = ['日','一','二','三','四','五','六'][now.getDay()];
    const hours = now.getHours(), mins = String(now.getMinutes()).padStart(2,'0');
    const period = hours < 12 ? '上午' : '下午', h12 = hours % 12 || 12;
    return `${m}月${d}日 星期${w} ${period}${h12}:${mins}`;
  }

  // ─── Data ───
  const BASIC = ['早安','午安','晚安','吃飽了嗎','天冷記得加衣服','記得多喝水'];
  const WISDOM = [
    '呼吸吧，你還活著',
    '沒有泥巴，就沒有蓮花',
    '每一步都走在淨土上',
    '微笑吧，生命是美好的',
    '當下這一刻，就是奇蹟',
  ];
  const WISDOM_POOL = [
    '呼吸吧，你還活著',
    '沒有泥巴，就沒有蓮花',
    '每一步都走在淨土上',
    '微笑吧，生命是美好的',
    '當下這一刻，就是奇蹟',
    '你不需要往外尋找平靜',
    '傾聽是一種深深的愛',
    '自由是幸福的基礎',
    '真正的愛，是理解',
    '平靜不是沒有風暴，而是在風暴中保持安寧',
    '讓我們享受每一步路',
    '你已經足夠好了',
    '理解即是愛的另一個名字',
    '真正的家，就是當下',
    '快樂的根源在於正念',
    '每一刻都是新的開始',
    '你的微笑就是你的力量',
    '走路時，每一步都是親吻大地',
    '內心的平靜從接納開始',
    '生命只存在於當下這一刻',
    '讓憤怒成為你的老師',
    '吃飯時，就只是吃飯',
    '苦與樂是同一條河流',
    '我們是生命的延續',
    '每一片葉子都是一個奇蹟',
    '幸福不是個人的事',
    '我已到了，我到家了',
    '無所求，即是幸福',
    '慈悲是最好的保護',
    '當你愛一朵花，你就會為它澆水',
    '覺察，是療癒的開始',
    '你看見花時，花也看見你',
    '放下，不是放棄，而是放開',
    '安靜地坐著，什麼都不做，春天來了，草自己長',
    '你想送給世界最好的禮物，就是你的平靜',
  ];
  const FONTS = {
    gensenrounded: '"GenSenRounded", "Noto Sans TC", sans-serif',
    wenkai: '"LXGW WenKai TC", serif',
    nanifont: '"NaniFont", "Noto Sans TC", sans-serif',
    notoserif: '"Noto Serif TC", serif',
    notosans: '"Noto Sans TC", sans-serif',
    huninn: '"jf-openhuninn", "Noto Sans TC", sans-serif',
    zenmaru: '"Zen Maru Gothic", "Noto Sans TC", sans-serif',
  };

  // ─── Sticker Config ───
  const STICKERS = [
    { id:'lotus', name:'蓮花', src:'stickers/flowers/lotus.svg', cat:'flowers', dx:620, dy:620 },
    { id:'sunflower', name:'向日葵', src:'stickers/flowers/sunflower.svg', cat:'flowers', dx:60, dy:620 },
    { id:'sakura', name:'櫻花', src:'stickers/flowers/sakura.svg', cat:'flowers', dx:60, dy:60 },
    { id:'butterfly', name:'蝴蝶', src:'stickers/animals/butterfly.svg', cat:'animals', dx:620, dy:60 },
    { id:'heart', name:'愛心', src:'stickers/symbols/heart.svg', cat:'symbols', dx:340, dy:640 },
    { id:'sparkle', name:'星星', src:'stickers/symbols/sparkle.svg', cat:'symbols', dx:340, dy:60 },
  ];

  // ─── Footer Year ───
  const sy = 2026, cy = new Date().getFullYear();
  document.getElementById('yr').textContent = cy > sy ? `${sy}\u2013${cy}` : `${sy}`;

  // ─── State ───
  let bgImage = null;
  let greetingColor = '#FFFFFF';
  let toColor = '#FFFFFF';
  let fromColor = '#FFFFFF';
  const COLORS = ['#FFFFFF', '#FFFF00', '#FF6B6B', '#333333', '#FFD700'];
  let fontSize = 52;
  let fontKey = 'gensenrounded';
  let textPos = 'mc';
  const activeStickers = new Set();
  const stickerImages = {};
  const stickerState = {}; // per-sticker { x, y, size }
  let selectedSticker = null;

  // ─── DOM ───
  const uploadArea = document.getElementById('upload-area');
  const uploadInput = document.getElementById('upload-input');
  const previewThumb = document.getElementById('preview-thumb');
  const textInput = document.getElementById('text-input');
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  const btnDownload = document.getElementById('btn-download');
  const toastEl = document.getElementById('toast');
  const bannerEl = document.getElementById('greeting-banner');
  const inputTo = document.getElementById('input-to');
  const inputFrom = document.getElementById('input-from');

  // ─── Helpers ───
  function clearGreetingActive() {
    document.querySelectorAll('.greeting-btn, .wisdom-btn').forEach(b => b.classList.remove('active'));
  }
  function fillBasic(t) { textInput.value = `${t}！\n${getDateTimeStr()}`; draw(); }
  function fillWisdom(t) { textInput.value = `${t}\n— 一行禪師\n${getDateTimeStr()}`; draw(); }

  // ─── Greeting Banner ───
  (function() {
    const now = new Date(), hours = now.getHours();
    const mins = String(now.getMinutes()).padStart(2,'0');
    const period = hours < 12 ? '上午' : '下午', h12 = hours % 12 || 12;
    bannerEl.innerHTML = `${getTimeGreeting()}！現在是${period}${h12}點${mins}分<br>幫你來張問安圖`;
  })();

  // ─── Greeting Buttons ───
  const autoG = getTimeGreeting();
  BASIC.forEach(g => {
    const btn = document.createElement('button');
    btn.className = 'greeting-btn' + (g === autoG ? ' active' : '');
    btn.textContent = g;
    btn.addEventListener('click', () => { clearGreetingActive(); btn.classList.add('active'); fillBasic(g); });
    document.getElementById('basic-row').appendChild(btn);
  });
  WISDOM.forEach(w => {
    const btn = document.createElement('button');
    btn.className = 'wisdom-btn';
    btn.textContent = w;
    btn.addEventListener('click', () => { clearGreetingActive(); btn.classList.add('active'); fillWisdom(w); });
    document.getElementById('wisdom-row').appendChild(btn);
  });
  // Random surprise button
  (function() {
    const btn = document.createElement('button');
    btn.className = 'wisdom-btn';
    btn.textContent = '✨ 隨機驚喜';
    btn.style.borderColor = 'var(--color-nadeshiko)';
    btn.addEventListener('click', () => {
      clearGreetingActive();
      btn.classList.add('active');
      const pick = WISDOM_POOL[Math.floor(Math.random() * WISDOM_POOL.length)];
      fillWisdom(pick);
    });
    document.getElementById('wisdom-row').appendChild(btn);
  })();
  fillBasic(autoG);

  // ─── Sticker Setup ───
  const stickerGrid = document.getElementById('sticker-grid');
  const stickerControlsEl = document.getElementById('sticker-controls');
  const stickerTitleEl = document.getElementById('sticker-controls-title');
  const sliderX = document.getElementById('sticker-x');
  const sliderY = document.getElementById('sticker-y');
  const sliderSize = document.getElementById('sticker-size');

  function selectStickerControls(id) {
    if (!id || !activeStickers.has(id)) {
      selectedSticker = null;
      stickerControlsEl.classList.remove('show');
      return;
    }
    selectedSticker = id;
    const s = STICKERS.find(st => st.id === id);
    const st = stickerState[id];
    stickerTitleEl.textContent = `調整「${s.name}」`;
    sliderX.value = st.x;
    sliderY.value = st.y;
    sliderSize.value = st.size;
    stickerControlsEl.classList.add('show');
  }

  STICKERS.forEach(s => {
    const img = new Image();
    img.src = s.src;
    img.onload = () => draw();
    stickerImages[s.id] = img;
    // Init default state
    stickerState[s.id] = { x: s.dx, y: s.dy, size: 130 };

    const wrap = document.createElement('div');
    wrap.style.textAlign = 'center';
    const thumb = document.createElement('div');
    thumb.className = 'sticker-thumb';
    const thumbImg = document.createElement('img');
    thumbImg.src = s.src;
    thumbImg.alt = s.name;
    thumb.appendChild(thumbImg);
    thumb.addEventListener('click', () => {
      if (activeStickers.has(s.id)) {
        // If clicking the same active sticker, deactivate
        activeStickers.delete(s.id);
        thumb.classList.remove('active');
        if (selectedSticker === s.id) selectStickerControls(null);
      } else {
        activeStickers.add(s.id);
        thumb.classList.add('active');
        selectStickerControls(s.id);
      }
      draw();
    });
    const label = document.createElement('div');
    label.className = 'sticker-name';
    label.textContent = s.name;
    wrap.appendChild(thumb);
    wrap.appendChild(label);
    stickerGrid.appendChild(wrap);
  });

  // Slider event handlers
  sliderX.addEventListener('input', () => {
    if (!selectedSticker) return;
    stickerState[selectedSticker].x = parseInt(sliderX.value);
    draw();
  });
  sliderY.addEventListener('input', () => {
    if (!selectedSticker) return;
    stickerState[selectedSticker].y = parseInt(sliderY.value);
    draw();
  });
  sliderSize.addEventListener('input', () => {
    if (!selectedSticker) return;
    stickerState[selectedSticker].size = parseInt(sliderSize.value);
    draw();
  });

  // ─── Upload ───
  uploadArea.addEventListener('click', () => uploadInput.click());
  uploadArea.addEventListener('dragover', e => { e.preventDefault(); uploadArea.classList.add('dragover'); });
  uploadArea.addEventListener('dragleave', () => uploadArea.classList.remove('dragover'));
  uploadArea.addEventListener('drop', e => {
    e.preventDefault(); uploadArea.classList.remove('dragover');
    if (e.dataTransfer.files[0]) handleFile(e.dataTransfer.files[0]);
  });
  uploadInput.addEventListener('change', e => { if (e.target.files[0]) handleFile(e.target.files[0]); });

  function handleFile(file) {
    if (!file.type.startsWith('image/')) return;
    const reader = new FileReader();
    reader.onload = e => {
      const img = new Image();
      img.onload = () => {
        bgImage = img;
        previewThumb.src = e.target.result;
        uploadArea.classList.add('has-image');
        btnDownload.disabled = false;
        draw();
      };
      img.src = e.target.result;
    };
    reader.readAsDataURL(file);
  }

  // ─── Font ───
  document.querySelectorAll('.font-btn').forEach(btn => {
    btn.addEventListener('click', async () => {
      document.querySelectorAll('.font-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      fontKey = btn.dataset.font;
      const fam = FONTS[fontKey].split(',')[0].trim().replace(/"/g,'');
      try { await document.fonts.load(`bold ${fontSize}px "${fam}"`); } catch(e){}
      draw();
    });
  });

  // ─── Color (greeting) ───
  document.querySelectorAll('.color-dot').forEach(dot => {
    dot.addEventListener('click', () => {
      document.querySelectorAll('.color-dot').forEach(d => d.classList.remove('active'));
      dot.classList.add('active');
      greetingColor = dot.dataset.color;
      if (dot.dataset.color === '#FFFFFF') dot.style.borderColor = '#CCC';
      draw();
    });
  });

  // ─── Color cycle (致 / 來自) ───
  function cycleColor(current) {
    const idx = COLORS.indexOf(current);
    return COLORS[(idx + 1) % COLORS.length];
  }
  function updateCycleDot(el, color) {
    el.style.background = color;
    el.style.borderColor = color === '#FFFFFF' ? '#CCC' : 'transparent';
  }
  document.getElementById('color-to').addEventListener('click', function() {
    toColor = cycleColor(toColor);
    updateCycleDot(this, toColor);
    draw();
  });
  document.getElementById('color-from').addEventListener('click', function() {
    fromColor = cycleColor(fromColor);
    updateCycleDot(this, fromColor);
    draw();
  });

  // ─── Size ───
  document.querySelectorAll('.size-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      fontSize = parseInt(btn.dataset.size);
      draw();
    });
  });

  // ─── Position ───
  document.querySelectorAll('.pos-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.pos-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      textPos = btn.dataset.pos;
      draw();
    });
  });

  // ─── Text / Name Inputs ───
  textInput.addEventListener('input', draw);
  inputTo.addEventListener('input', draw);
  inputFrom.addEventListener('input', draw);

  // ─── Draw ───
  function draw() {
    const w = 800, h = 800;
    canvas.width = w; canvas.height = h;

    // Background
    if (bgImage) {
      const sc = Math.max(w / bgImage.width, h / bgImage.height);
      const sw = bgImage.width * sc, sh = bgImage.height * sc;
      ctx.drawImage(bgImage, (w - sw) / 2, (h - sh) / 2, sw, sh);
    } else {
      ctx.fillStyle = '#F5D0C5';
      ctx.fillRect(0, 0, w, h);
    }

    // Stickers (behind text) — use per-sticker state
    STICKERS.forEach(s => {
      if (!activeStickers.has(s.id)) return;
      const img = stickerImages[s.id];
      const st = stickerState[s.id];
      if (img.complete) ctx.drawImage(img, st.x, st.y, st.size, st.size);
    });

    // Build all lines with type for per-line coloring
    const toName = inputTo.value.trim();
    const fromName = inputFrom.value.trim();
    const mainText = textInput.value.trim();

    const allLines = [];
    if (toName) allLines.push({ text: `致 ${toName}`, small: true, type: 'to' });
    if (mainText) mainText.split('\n').forEach(line => {
      const isSmall = line.startsWith('—') || line.match(/^\d+月/);
      allLines.push({ text: line, small: isSmall, type: 'greeting' });
    });
    if (fromName) allLines.push({ text: `來自 ${fromName}`, small: true, type: 'from' });

    if (!allLines.length) return;

    const fontFamily = FONTS[fontKey];
    const lineH = fontSize * 1.5;
    const totalH = allLines.length * lineH;
    const pad = 40;

    const col = textPos[1];
    const hAlign = col === 'l' ? 'left' : col === 'r' ? 'right' : 'center';
    const xPos = col === 'l' ? pad : col === 'r' ? w - pad : w / 2;
    const row = textPos[0];
    let startY;
    if (row === 't') startY = pad + fontSize;
    else if (row === 'b') startY = h - totalH - pad + fontSize;
    else startY = (h - totalH) / 2 + fontSize;

    ctx.textAlign = hAlign;
    ctx.textBaseline = 'middle';

    allLines.forEach((line, i) => {
      const y = startY + i * lineH;
      const size = line.small ? Math.round(fontSize * 0.6) : fontSize;

      ctx.font = `bold ${size}px ${fontFamily}`;
      ctx.strokeStyle = 'rgba(0,0,0,0.6)';
      ctx.lineWidth = size * 0.12;
      ctx.lineJoin = 'round';
      ctx.strokeText(line.text, xPos, y);
      ctx.fillStyle = line.type === 'to' ? toColor : line.type === 'from' ? fromColor : greetingColor;
      ctx.fillText(line.text, xPos, y);
    });
  }

  document.fonts.ready.then(draw);

  // ─── Download ───
  btnDownload.addEventListener('click', () => {
    if (!bgImage) { toast('請先選一張背景'); return; }
    const link = document.createElement('a');
    link.download = '問安圖.png';
    link.href = canvas.toDataURL('image/png');
    link.click();
    toast('圖片已下載');
  });

  function toast(msg) {
    toastEl.textContent = msg;
    toastEl.classList.add('show');
    setTimeout(() => toastEl.classList.remove('show'), 2000);
  }
</script>
</body>
</html>
